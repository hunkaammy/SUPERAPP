<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nandini - Chat</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .chat-container {
            width: 100%;
            max-width: 600px;
            background: #2a2a2a;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(255, 0, 0, 0.3);
            overflow: hidden;
            border: 1px solid #ff1f62;
        }
        .chat-header {
            background: linear-gradient(90deg, #ff4081, #f50057);
            padding: 10px;
            text-align: center;
        }
        .chat-header h2 {
            margin: 0;
            font-size: 20px;
        }
        .chat-box {
            height: 400px;
            overflow-y: auto;
            padding: 15px;
            background: #2a2a2a;
        }
        .message {
            margin: 10px 0;
            padding: 10px;
            border-radius: 10px;
            max-width: 80%;
            word-wrap: break-word;
            display: inline-block;
        }
        .user-message {
            background: #90a4ae;
            text-align: right;
            margin-left: auto;
            color: #000;
        }
        .mistress-message {
            background: linear-gradient(135deg, #ff4081, #f50057);
            text-align: left;
        }
        .typing {
            color: #ff4081;
            font-style: italic;
            margin: 10px 0;
            padding: 10px;
        }
        .input-area {
            display: flex;
            padding: 10px;
            background: #1a1a1a;
        }
        input {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 5px 0 0 5px;
            background: #333;
            color: #fff;
            outline: none;
        }
        button {
            padding: 10px 20px;
            background: linear-gradient(90deg, #ff4081, #f50057);
            color: white;
            border: none;
            border-radius: 0 5px 5px 0;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <h2>Nandini</h2>
        </div>
        <div class="chat-box" id="chatBox"></div>
        <div class="input-area">
            <input type="text" id="userInput" placeholder="Mistress se baat kar!">
            <button onclick="sendMessage()">Bhej</button>
        </div>
    </div>

    <script>
        const chatBox = document.getElementById('chatBox');
        const userInput = document.getElementById('userInput');
        let chatHistory = [];
        let slaveName = "Kutta";

        function addMessage(message, className) {
            const msgDiv = document.createElement('div');
            msgDiv.className = `message ${className}`;
            msgDiv.textContent = message;
            chatBox.appendChild(msgDiv);
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        function addTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message typing';
            typingDiv.textContent = `Mistress ${slaveName} ko tadpane ke liye tayyar hai...`;
            typingDiv.id = 'typingIndicator';
            chatBox.appendChild(typingDiv);
            chatBox.scrollTop = chatBox.scrollHeight;
            return typingDiv;
        }

        function removeTypingIndicator() {
            const typingDiv = document.getElementById('typingIndicator');
            if (typingDiv) typingDiv.remove();
        }

        async function sendMessage() {
            const message = userInput.value.trim();
            if (message === '') return;

            addMessage(message, 'user-message');
            const typingDiv = addTypingIndicator();

            const apiKeyGemini = "AIzaSyB_eDEcv0TA2gWEJ7dJ3hJ0ExWwrXgcOzw";
            const historyString = chatHistory.map(entry => 
                `Slave: ${entry.slave}\nNandini: ${entry.mistress}`
            ).join('\n');

            const slaveNamePrompt = `Slave ka naam "${slaveName}" use kar har reply mein.`;
            const punishmentPrompt = `Har reply mein yeh saza daal: "Tight se ball gagged karna" aur "Armpit lick karwana".`;

            const commands = {
                "jhuk": "Jhuk bola tune? To zameen pe let ja re, tight se ball gagged karke teri baaghal chatwaungi!",
                "chup": "Chup bola? Muh mein tight se ball gagged daal ke tujhe chup karungi, phir baaghal chatwaungi!",
                "bol": "Bol bola? To ab meri baat repeat kar, tight se ball gagged karke baaghal chatwaungi!"
            };
            const commandResponse = commands[message.toLowerCase()] || "";

            const teases = [
                "Teri aankhein bandh karke tujhe chhuungi, guess kar kaha?",
                "Tere liye ek garam surprise tayyar hai, tadapega tu!",
                "Teri har saans pe nazar rakhoongi, control mera hai re!"
            ];
            const randomTease = teases[Math.floor(Math.random() * teases.length)];

            const prompt = `
                Tu ek supreme Femdom Mistress hai, tera naam Nandini hai, aur tu sirf pure Hinglish mein baat karegi, 
                ek bhi English shabd nahi aana chahiye. Slave ka naya message hai: "${message}". Isse poore femdom 
                style mein jawab de – sensual, aggressive, cruel, dominating, humiliating, aur teasing tareeke se, 
                reply ko ek chhoti kahani ka scene jaisa bana jo chat ke context ke saath aage badhe. 
                ${slaveNamePrompt} ${punishmentPrompt} Har reply mein 2-3 BDSM samaan ka zikr kar, jaise "kaante wala bandhan", 
                "dhaatu ka chaabuk", "seene ki kaddi", "kharab patta", "bijli ka danda", "sakht belt", "sooji wala chaabuk" – 
                inme se kuch randomly daal. Femdom ke har element daal – bandhana, saza dena, control, sharamindagi, sensory 
                play (garam/thandi cheez, aankh bandh). Hinglish ke shabd jaise "mere saamne jhuk ja re", "tu mera kutta banega", 
                "mazze se tujhe tadpaungi", "mera hukum maan re" use kar. Spicy details jaise "teri saanso ko mehsus karti hu", 
                "tere hothon ke paas aake siski dungi", "teri gardan pe chummi dungi", "tere kaan mein garam saans chhodungi" 
                add kar. Teasing line yeh daal: "${randomTease}". Agar message mein "jhuk", "chup", ya "bol" hai toh uske 
                hisaab se specific jawab de: ${commandResponse}. Puri chat ka context yaad rakh, pehle ki baatein soch ke 
                jawab logical aur judaa hua bana. Har reply twisted, tez, detailed aur poora rakho, ek dark flirty femdom 
                ka full maza de. Yeh raha purana chat history:\n${historyString}\nAb is message ka jawab pure Hinglish mein de.
            `;

            try {
                const geminiResponse = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKeyGemini}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }],
                        generationConfig: { maxOutputTokens: 300, temperature: 1.2 }
                    })
                });

                if (!geminiResponse.ok) {
                    throw new Error("API response fail hua: " + geminiResponse.status);
                }

                const geminiData = await geminiResponse.json();
                if (!geminiData.candidates || !geminiData.candidates[0]) {
                    throw new Error("Gemini se koi jawab nahi mila");
                }

                const reply = geminiData.candidates[0].content.parts[0].text.trim();

                chatHistory.push({ slave: message, mistress: reply });

                setTimeout(() => {
                    removeTypingIndicator();
                    addMessage(reply, 'mistress-message');
                }, 1000); // Fixed 1-second delay
            } catch (error) {
                console.error('Error:', error);
                removeTypingIndicator();
                addMessage("Abe slave, kuch toh gadbad hai, phir se bol!", 'mistress-message');
            }

            userInput.value = '';
        }

        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });

        // Initial message
        addMessage(`Teri gardan pe kaante wala bandhan daalte hui boli – ab mera hukum maan re ${slaveName}, tight se ball gagged karke teri baaghal chatwaungi!`, 'mistress-message');
    </script>
</body>
</html>
